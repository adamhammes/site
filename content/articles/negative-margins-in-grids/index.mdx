---
title: "Negative margins in padded grids"
description: "TODO"
date: 2019-06-30T09:40:53-04:00
draft: true
---

import styles from "./negative-margins-grid.module.scss";

This is a layout I find myself having to create in basically every site I work on:

<ul class={styles.gridList}>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
</ul>

...that is, an evenly spaced grid with gutters.
Now, this is a completely trivial layout to code if you are allowed to use `display: grid`.
However, most projects I've worked on have supported Internet Explorer, which does not support `grid-gap`.

## With justify-content: space between

The solution for my first project was to use `justify-content: space-between`:

```scss
.grid--space-space-between {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
}

.grid--space-space-between > li {
  width: 31%;
}
```

<ul class={styles.spaceBetween}>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
</ul>

There are two problems with this approach, however:

1. We've given up precise control of the gutter size.
2. If we have a number of items that doesn't divide evenly our number of columns, we'll get unwanted gaps:

<ul class={styles.spaceBetween}>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
</ul>

The first problem can be handled with a bit of `calc` trickery, but the second is
fundamental to our usage of `justify-content: space-between`.

## With calc + nth-child

The solution I used on my second project involved some trickery with `calc` and `nth-child`:

```css
.grid--calc-trickery {
  --gutter-size: 1rem;

  display: flex;
  flex-wrap: wrap;
}

.grid--calc-trickery > li {
  /* 
   * Here, we are calculating the width of each columns minus the two gutters.
   * The gutters are added as `margin-right` on the list items.
   */
  width: calc(33.3333% - calc(var(--gutter-size) / 3 * 2));
  margin-right: var(--gutter-size);
}

.grid--calc-trickery > li:nth-child(3n) {
  /* 
   * Take off the margin of the right-most item of each row to prevent it from
   * wrapping.
  */
  margin-right: 0;
}
```

<ul class={styles.calcTrickery}>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
</ul>

The `calc` magic we used here does fix both of the problems with the previous
approach. We have precise control over the size of the gutters, and the
layout works as desired with 5 children.

However, this is a more complex solution, and is particularly difficult to
make responsive.

As you might have guessed from the title of the article, our final solution
will take advantage of negative margins. Here's the css:

## With negative margins

```css
.grid--negative-margins {
  --gutter-size: 1rem;
  display: flex;
  margin: calc(2 * var(--rhythm)) calc(-0.5 * var(--gutter-size));
}

..grid--negative-margins > li {
  width: 33.333333%;
  padding: calc(0.5 * var(--gutter-size));
}
```

<ul class={styles.negativeMargins}>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
</ul>

.GgsGs

## Bonus layout: actually using grid

```css
.grid--grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-column-gap: 1rem;
}
```

<ul class={styles.actualGrid}>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
  <li>
    <div />
  </li>
</ul>

asdf
